{"version":3,"sources":["auth/facebook/passport.js"],"names":[],"mappings":";;;;;QAGgB,K,GAAA,K;;AAHhB;;;;AACA;;;;AAEO,SAAS,KAAT,CAAe,IAAf,EAAqB,MAArB,EAA6B;AAClC,qBAAS,GAAT,CAAa,+BAAqB;AAChC,cAAU,OAAO,QAAP,CAAgB,QADM;AAEhC,kBAAc,OAAO,QAAP,CAAgB,YAFE;AAGhC,iBAAa,OAAO,QAAP,CAAgB,WAHG;AAIhC,mBAAe,CACb,aADa,EAEb,QAFa;AAJiB,GAArB,EASb,UAAS,WAAT,EAAsB,YAAtB,EAAoC,OAApC,EAA6C,IAA7C,EAAmD;AACjD,SAAK,OAAL,CAAa,EAAC,eAAe,QAAQ,EAAxB,EAAb,EAA0C,IAA1C,GACG,IADH,CACQ,gBAAQ;AACZ,UAAI,IAAJ,EAAU;AACR,eAAO,KAAK,IAAL,EAAW,IAAX,CAAP;AACD;;AAED,aAAO,IAAI,IAAJ,CAAS;AACd,cAAM,QAAQ,WADA;AAEd,eAAO,QAAQ,MAAR,CAAe,CAAf,EAAkB,KAFX;AAGd,cAAM,MAHQ;AAId,kBAAU,UAJI;AAKd,kBAAU,QAAQ;AALJ,OAAT,CAAP;AAOA,WAAK,IAAL,GACG,IADH,CACQ;AAAA,eAAQ,KAAK,IAAL,EAAW,IAAX,CAAR;AAAA,OADR,EAEG,KAFH,CAES;AAAA,eAAO,KAAK,GAAL,CAAP;AAAA,OAFT;AAGD,KAhBH,EAiBG,KAjBH,CAiBS;AAAA,aAAO,KAAK,GAAL,CAAP;AAAA,KAjBT;AAkBD,GA5BY,CAAb;AA6BD","file":"auth/facebook/passport.js","sourcesContent":["import passport from 'passport';\r\nimport {Strategy as FacebookStrategy} from 'passport-facebook';\r\n\r\nexport function setup(User, config) {\r\n  passport.use(new FacebookStrategy({\r\n    clientID: config.facebook.clientID,\r\n    clientSecret: config.facebook.clientSecret,\r\n    callbackURL: config.facebook.callbackURL,\r\n    profileFields: [\r\n      'displayName',\r\n      'emails'\r\n    ]\r\n  },\r\n  function(accessToken, refreshToken, profile, done) {\r\n    User.findOne({'facebook.id': profile.id}).exec()\r\n      .then(user => {\r\n        if (user) {\r\n          return done(null, user);\r\n        }\r\n\r\n        user = new User({\r\n          name: profile.displayName,\r\n          email: profile.emails[0].value,\r\n          role: 'user',\r\n          provider: 'facebook',\r\n          facebook: profile._json\r\n        });\r\n        user.save()\r\n          .then(user => done(null, user))\r\n          .catch(err => done(err));\r\n      })\r\n      .catch(err => done(err));\r\n  }));\r\n}\r\n"],"sourceRoot":"/source/"}